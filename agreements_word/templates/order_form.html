{%extends 'base.html'%}

{%block content%}

<div class="content" >
<form action="" method="post">
        {{ form.csrf_token }}
    <table class="table table-sm table-dark" border="2px" style="background-color:#D8D29A;">

        <thead >
<tr>
     <th>{{form.customer_name.label()}}</th> 
     <th  >{{form.supplier_name.label}}  </th>  
    <th>{{form.date_order.label()}}</th>
   
    
       </tr> 
    </thead>
    
    <tbody>
        <tr>
            
               <td>{{form.customer_name}}
                    <div class="form-check"></div>
                    <input type="checkbox" class="form-check-input" id="exampleCheck1" name='add_cust' onclick="Show_req_cust()">
                    <script>
                    function Show_req_cust(){
                        var x = document.querySelectorAll("[id=req_cust]")
                        x.forEach(function(el){
                        
                        if (el.style.display == 'none'){
                        el.style.display = 'block'
                   
                         }else{
                        el.style.display = "none"
                        } 
                    }
                    )
                    }
                    </script>
                    <label class="form-check-label" for="exampleCheck1" >Заявка с клиентом</label>
                  </div>
               </td>
               
               <td >{{form.supplier_name}}
                    <div class="form-check">
                    <input type="checkbox" class="form-check-input" id="exampleCheck1" name='add_supp' onclick="Show_req_supp()">
                    </div><script>
                     function Show_req_supp(){
                        
                        var x = document.querySelectorAll("[id=req_supp]");
                        
                        x.forEach(function(el){
                        
                            if (el.style.display == 'none'){
                            el.style.display = 'block'
                       
                             }else{
                            el.style.display = "none"
                            } 
                        }
                        )
                    }

             
                
                       
                    
                    </script>
                    <label class="form-check-label" for="exampleCheck1" >Заявка с поставщиком</label>
                  </div>

               </td>
            <td>{{form.date_order}}
                    
            </td>
            
               
        </tr>
    </tbody>

   

 </table>
    <p></p>
    <p></p>
    <p></p>

    <div> Загрузка
        <table class="table table-sm table-dark" border='2px' style="background-color:#B1D89A;">
    
                <thead >
        <tr>
            <th>{{form.o_from.label()}}</th>
            <th>{{form.address_loading.label()}}</th>
            <th>{{form.type_loading.label}}</th> 
            <th>{{form.shipper_name.label()}}</th>   
            <th>{{form.date_loading.label()}}</th> 
            <th>{{form.time_loading.label()}}</th>
            <th>{{form.contacts_loading.label()}}</th>
            
               </tr> 
            </thead>
            <tbody>
                <tr>
                        <td>{{form.o_from}}</td>
                       <td>{{form.address_loading}}</td>
                       <td>{{form.type_loading(placeholder='зад, бок, верх, полная растентовка')}}</td>
                       <th>{{form.shipper_name}}</th> 
                       <td>{{form.date_loading}}</td>
                        <td>{{form.time_loading(placeholder= 'например с 8:00 до 17:00' )}}</td>
                        <td>{{form.contacts_loading(placeholder='Иван Иванович тел 8999999')}}</td>
                       
                </tr>
            </tbody>
        
           
        
         </table>
    
      </div>
    
    
    <p></p>
    <p></p>
    <p></p>


  <div>Выгрузка
        <table class="table table-sm table-dark", border="2px" style="background-color:#9ACBD8;">

                <thead >
        <tr>
            
           
            <th>{{form.o_to.label()}}</th> 
            <th>{{form.address_unloading.label()}}</th>  
            <th>{{form.type_unloading.label}}</th>
            <td>{{form.cnee_name.label()}}</td>
            
            <th>{{form.date_unloading.label()}}</th>
            <th>{{form.time_unloading.label()}}</th>
            <th>{{form.contacts_unloading.label()}}</th>
            
            
               </tr> 
            </thead>
            <tbody>
                <tr>
                  
                       <td>{{form.o_to}}</td>
                       <td>{{form.address_unloading}}</td>
                       <td>{{form.type_unloading(placeholder='бок, зад, полная растентовка')}}</td>
                       <td>{{form.cnee_name}}</td>
                       

                        
                       <td>{{form.date_unloading}}</td>
                      <td>{{form.time_unloading(placeholder='например c 8 до 15:00 строго')}}</td>
                       <td>{{form.contacts_unloading(placeholder='Иван етрович +78663333')}}</td>
                   
                    
                       
                </tr>
            </tbody>
        
           
        
         </table>

  </div>
    




<p></p>
<p></p>
<p></p>
<p></p>

<div> Все о грузе
        <table class="table table-sm table-dark" border='2px' style="background-color:#9AD8B8;">
    
                <thead >
        <tr>
            <th>{{form.cargo_description.label()}}</th>
            <th>{{form.quantity_pallets.label()}}</th> 
            <th>{{form.weigth.label()}}</th>  
            <th>{{form.volume.label}}</th> 
            <th>{{form.cargo_cost.label()}}</th>
            <th>{{form.cargo_comments.label}}</th>
            
            
               </tr> 
            </thead>
            <tbody>
                <tr>
                       <td>{{form.cargo_description}}</td>
                       <td>{{form.quantity_pallets}}</td>
                       <th>{{form.weigth}}</th>
                       <th>{{form.volume}}</th>
                       <th>{{form.cargo_cost}}</th>
                       <th>{{form.cargo_comments}}</th>
                       
                       
                </tr>
            </tbody>
        
           
        
         </table>
    
      </div>
      





         <div> Данные на Авто
                <table class="table table-sm table-dark" border='2px' style="background-color:#9ACBD8;">
            
                        <thead >
                <tr>
                    <th>{{form.model.label}}</th>
                    <th>{{form.auto_number.label}}</th>
                    <th>{{form.driver_name.label}}</th>
                    <th>{{form.driver_phone.label}}</th>
                    <th>{{form.passport.label}}</th>
                    <th>{{form.driver_license.label}}</th>
                    <th>{{form.type_truck.label}}</th>
                    
                    
                       </tr> 
                    </thead>
                    <tbody>
                        <tr>
                                    <td>{{form.model}}</td>
                                    <td>{{form.auto_number}}</td>          
                                    <td>{{form.driver_name}}</td>   
                                    <td>{{form.driver_phone}}</td>   
                                    <td>{{form.passport}}</td> 
                                    <td>{{form.driver_license}}</td>
                                    <th>{{form.type_truck}}</th>        
                               
                        </tr>
                    </tbody>
                
                   
                
                 </table>
            
              </div>

              <div id='req_supp' style="display:none" >Условия оплаты с перевозчиком
                  

                    <table class="table table-sm table-dark" border='2px' style="background-color:#D8B99A;">
                
                            <thead >
                    <tr>
                        <th>{{form.cost.label}}</th>
                        <th>{{form.org_scan.label}}</th>
                        <th>{{form.date_payment.label}}</th>
            
                            
            
                        
                        
                           </tr> 
                        </thead>
                        <tbody>
                            <tr>
                                   <td>{{form.cost}}</td>
                                   <th>{{form.org_scan(placeholder='Скан или квиток, аванс и т.д.')}}</th>
                                   <th>{{form.date_payment}}</th>
            
                                  
                                   
            
            
                                   
                                   
                            </tr>
                        </tbody>
                    
                       
                    
                     </table>
                    </div>

                    <div id='req_cust' style="display:none">Условия оплаты с клиентом

                            <table class="table table-sm table-dark" border='2px' style="background-color:#D8B99A;">
                
                                    <thead >
                            <tr>
                                <th>{{form.cost_c.label}}</th>
                                <th>{{form.org_scan_с.label}}</th>
                                <th>{{form.date_payment_с.label}}</th>
                    
                                    
                    
                                
                                
                                   </tr> 
                                </thead>
                                <tbody>
                                    <tr>
                                           <td>{{form.cost_c}}</td>
                                           <th>{{form.org_scan_с(placeholder='Скан или квиток, аванс и т.д.')}}</th>
                                           <th>{{form.date_payment_с}}</th>
                    
                                          
                                           
                    
                    
                                           
                                           
                                    </tr>
                                </tbody>

                    </div>

                    <div id='req_cust' style="display:none">

                           

                            <table class="table table-sm table-dark" border='2px' style="background-color:#D8B09A;">
                        
                                    <thead >Банковские реквизиты клиента
                            <tr>
                                <th>{{form.cust_legal_address.label}}</th>
                                <th>{{form.cust_fact_address.label}}</th>
                                <th>{{form.cust_inn.label}}</th>
                                <th>{{form.cust_kpp.label}}</th>
                                <th>{{form.cust_bank.label}}</th>
                                <th>{{form.cust_bik_bank.label}}</th>
                                <th>{{form.cust_accout.label}}</th>
                                <th>{{form.cust_bank_kc.label}}</th>
                                
                             
                                <th>{{form.cust_sign_fio.label}}</th>
                    
                                    
                    
                                
                                
                                   </tr> 
                                </thead>
                                <tbody>
                                    <tr>
                                        <th>{{form.cust_legal_address}}</th>
                                        <td>{{form.cust_fact_address}}</td>
                                        <td>{{form.cust_inn}}</td>
                                        <td>{{form.cust_kpp}}</td>
                                        <td>{{form.cust_bank}}</td>
                                        <td>{{form.cust_bik_bank}}</td>
                                           <td>{{form.cust_accout}}</td>
                                           <td>{{form.cust_bank_kc}}</td>
                                          
                                           
                                           <td>{{form.cust_sign_fio(placeholder='Иванов И.И')}}</td>
                                         
                    
                                          
                                           
                    
                    
                                           
                                           
                                    </tr>
                                </tbody>
                            
                               
                            
                             </table>
                            </div>

                            <div id='req_supp' style="display:none">Банковские реквизиты перевозчика

                                <script>
                                    document.getElementById('req_supp').style.display='none';
                                    </script>

                                    <table class="table table-sm table-dark" border='2px' style="background-color:#D8B09A;">
                                
                                            <thead >
                                    <tr>
                                        <th>{{form.supp_legal_address.label}}</th>
                                        <th>{{form.supp_fact_address.label}}</th>
                                        <th>{{form.supp_inn.label}}</th>
                                        <th>{{form.supp_kpp.label}}</th>
                                        <th>{{form.supp_bank.label}}</th>
                                        <th>{{form.supp_bank_bik.label}}</th>
                                        <th>{{form.supp_accout.label}}</th>
                                        <th>{{form.supp_bank_kc.label}}</th>
                                        
                                     
                                        <th>{{form.supp_sign_fio.label}}</th>
                            
                                            
                            
                                        
                                        
                                           </tr> 
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <th>{{form.supp_legal_address}}</th>
                                                <td>{{form.supp_fact_address}}</td>
                                                <td>{{form.supp_inn}}</td>
                                                <td>{{form.supp_kpp}}</td>
                                                <td>{{form.supp_bank}}</td>
                                                <td>{{form.supp_bank_bik}}</td>
                                                   <td>{{form.supp_accout}}</td>
                                                   <td>{{form.supp_bank_kc}}</td>
                                                  
                                                   
                                                   <td>{{form.supp_sign_fio(placeholder='Иванов И.И')}}</td>
                                                 
                            
                                                  
                                                   
                            
                            
                                                   
                                                   
                                            </tr>
                                        </tbody>
                                    
                                       
                                    
                                     </table>
                                    </div>
              
         {{form.submit}}
    
      </div>
    </form>

   

  <div >
<table id='dtBasicExample' class="table table-hover" >
    <thead>
       <th>id</th>
        <th scope="col">Заявка</th>
        <th>Водитель</th>
        <th>Дата заявки</th>
        <th>Дата погрузки</th>
        

          
    </thead>
    <tbody id='inv1'>
            <input class="form-control" id="myInput" type="text" placeholder="Search..">
        {%for row in all_agr_db%}
        {%if row%}
        <tr>
            <td id='a_id' width='10'>{{row.id}}</td>
            <td scope="col" width='800'>
                {%if row.path%}
               <a href="{{url_for('.download_agr', filename=row.path)}}"> {{row.path}}
            
                    <a href="#" onclick='f1(event)'>
                            <span id='sp' class="glyphicon glyphicon-remove-sign"></span>
                          </a>
                          {%endif%}
            </td>
            <td>{{row.driver}}</td>
            <td>{{row.date_order}}</td>
            <td>{{row.date_loading}}</td>
        </tr>

        {%endif%}
        {%endfor%}
        
    </tbody>
</table>
</div>






{%endblock%}

{%block scripts%}




<script>


$(document).ready(function() {

        
$('#customer_name').select2();
$('#supplier_name').select2();



})
   
    </script>
   
    <script>
     function f1(event){
         let a=event.target.parentNode.parentNode
         let c=a.previousElementSibling
         console.log(c.innerHTML)
         const id = c.innerHTML;
         if(confirm('Удалить заявку. Вы уверены?'))
         {
             $.getJSON('/agreements/delete_agr/'+ id, {
                id:id,

             }, function(data){
                 console.log(data);
                
             }
             

             )

       window.location.reload(); 

        }else{
            (console.log('d'))
        }
        
    } 
   
   
    
    </script>

    
    
    <script>
                            $(document).ready(function(){
                              $("#myInput").on("keyup", function() {
                                var value = $(this).val().toLowerCase();
                                $("#dtBasicExample tr").filter(function() {
                                  $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                                });
                              });
                            });
                      
    </script>
    {%endblock%}